<!DOCTYPE html>
<html>
  <body>
    <h1>OpenQ ABI Encoder</h1>
    <form name="inputParamsForm" id="input-params-form">
      <h3>Bounty Type</h3>

      <input type="radio" id="atomic" name="bountyType" value="0" checked />
      <label for="atomic">Atomic</label><br />

      <input type="radio" id="ongoing" name="bountyType" value="1" />
      <label for="ongoing">Ongoing</label><br />

      <input type="radio" id="tiered-percentage" name="bountyType" value="2" />
      <label for="tiered-percentage">Tiered Percentage</label><br />

      <input type="radio" id="tiered-fixed" name="bountyType" value="3" />
      <label for="tiered-fixed">Tiered Fixed</label><br /><br />

      <div id="hasFundingGoalInput">
        <label for="hasFundingGoal">hasFundingGoal</label>
        <input
          type="text"
          id="hasFundingGoal"
          name="hasFundingGoal"
          value="true"
        /><br /><br />
      </div>

      <div id="fundingTokenInput">
        <label for="fundingToken">fundingToken</label>
        <input
          type="text"
          id="fundingToken"
          name="fundingToken"
          value="0x947F3FC93AB8b74C44F837d3031347DDBb32cf08"
        /><br /><br />
      </div>

      <div id="fundingGoalInput">
        <label for="fundingGoal">fundingGoal</label>
        <input
          type="text"
          id="fundingGoal"
          name="fundingGoal"
          value="100"
        /><br /><br />
      </div>

      <div id="payoutScheduleInput">
        <label for="payoutSchedule">payoutSchedule</label>
        <input
          type="text"
          id="payoutSchedule"
          name="payoutSchedule"
          value="[60,30,20]"
        />
        <br /><br />
      </div>

      <div id="payoutTokenAddressInput">
        <label for="payoutTokenAddress">payoutTokenAddress</label>
        <input
          type="text"
          id="payoutTokenAddress"
          name="payoutTokenAddress"
          value="0x947F3FC93AB8b74C44F837d3031347DDBb32cf08"
        />
        <br /><br />
      </div>

      <div id="payoutVolumeInput">
        <label for="payoutVolume">payoutVolume</label>
        <input type="text" id="payoutVolume" name="payoutVolume" value="100" />
        <br /><br />
      </div>

      <div id="invoiceRequiredInput">
        <label for="invoiceRequired">invoiceRequired</label>
        <input
          type="text"
          id="invoiceRequired"
          name="invoiceRequired"
          value="true"
        /><br /><br />
      </div>

      <div id="kycRequiredInput">
        <label for="kycRequired">kycRequired</label>
        <input
          type="text"
          id="kycRequired"
          name="kycRequired"
          value="true"
        /><br /><br />
      </div>

      <div id="supportingDocumentsRequiredInput">
        <label for="supportingDocumentsRequired"
          >supportingDocumentsRequired</label
        >
        <input
          type="text"
          id="supportingDocumentsRequired"
          name="supportingDocumentsRequired"
          value="true"
        /><br /><br />
      </div>

      <div id="issuerExternalUserIdInput">
        <label for="issuerExternalUserId">issuerExternalUserId</label>
        <input
          type="text"
          id="issuerExternalUserId"
          name="issuerExternalUserId"
          value="issuerExternalUserId"
        /><br /><br />
      </div>

      <div id="alternativeNameInput">
        <label for="alternativeName">alternativeName</label>
        <input
          type="text"
          id="alternativeName"
          name="alternativeName"
          value="alternativeName"
        /><br /><br />
      </div>

      <div id="alternativeLogoInput">
        <label for="alternativeLogo">alternativeLogo</label>
        <input
          type="text"
          id="alternativeLogo"
          name="alternativeLogo"
          value="alternativeLogo"
        /><br /><br />
      </div>

      <input type="submit" value="Submit" />
    </form>
    <div style="display: block; width: 200px;">
      <p id="encoded-data" style="width: 50%;">DATA</p>
    </div>
  </body>
  <script src="index.js"></script>
  <script
    src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js"
    type="application/javascript"
  ></script>
  <script>
    var form = document.getElementById('input-params-form')
    var currentBountyType = '0'

    function handleForm(event) {
      event.preventDefault()
      const form = document.querySelector('form')

      const inputs = Object.values(form).reduce((obj, field) => {
        obj[field.name] = field.value
        return obj
      }, {})

      const {
        hasFundingGoal,
        fundingToken,
        fundingGoal,
        invoiceRequired,
        kycRequired,
        supportingDocumentsRequired,
        issuerExternalUserId,
        alternativeName,
        alternativeLogo,
        payoutSchedule,
        payoutTokenAddress,
        payoutVolume,
      } = inputs

      let encodedData
      if (currentBountyType == 0) {
        encodedData = Encoder.atomicEncode(
          hasFundingGoal,
          fundingToken,
          fundingGoal,
          invoiceRequired,
          kycRequired,
          supportingDocumentsRequired,
          issuerExternalUserId,
          alternativeName,
          alternativeLogo
        )
      } else if (currentBountyType == 1) {
        encodedData = Encoder.ongoingEncode(
          payoutTokenAddress,
          payoutVolume,
          hasFundingGoal,
          fundingToken,
          fundingGoal,
          invoiceRequired,
          kycRequired,
          supportingDocumentsRequired,
          issuerExternalUserId,
          alternativeName,
          alternativeLogo
        )
      } else if (currentBountyType == 2) {
        encodedData = Encoder.tieredPercentageEncode(
          payoutSchedule,
          hasFundingGoal,
          fundingToken,
          fundingGoal,
          invoiceRequired,
          kycRequired,
          supportingDocumentsRequired,
          issuerExternalUserId,
          alternativeName,
          alternativeLogo
        )
      } else {
        encodedData = Encoder.tieredFixedEncode(
          payoutSchedule,
          payoutTokenAddress,
          invoiceRequired,
          kycRequired,
          supportingDocumentsRequired,
          issuerExternalUserId,
          alternativeName,
          alternativeLogo
        )
      }

      document.getElementById('encoded-data').innerHTML = encodedData
    }

    form.addEventListener('submit', handleForm)

    var rad = document.inputParamsForm.bountyType
    var prev = null
    for (var i = 0; i < rad.length; i++) {
      rad[i].addEventListener('change', function () {
        currentBountyType = this.value
        if (currentBountyType == 0) {
          // HIDE
          document.getElementById('payoutScheduleInput').style.display = 'none'
          document.getElementById('payoutTokenAddressInput').style.display =
            'none'
          document.getElementById('payoutVolumeInput').style.display = 'none'

          // SHOW
          document.getElementById('hasFundingGoalInput').style.display = 'block'
          document.getElementById('fundingTokenInput').style.display = 'block'
          document.getElementById('fundingGoalInput').style.display = 'block'
        } else if (currentBountyType == 1) {
          // HIDE
          document.getElementById('payoutScheduleInput').style.display = 'none'

          // SHOW
          document.getElementById('hasFundingGoalInput').style.display = 'block'
          document.getElementById('fundingTokenInput').style.display = 'block'
          document.getElementById('fundingGoalInput').style.display = 'block'
          document.getElementById('payoutTokenAddressInput').style.display =
            'block'
          document.getElementById('payoutVolumeInput').style.display = 'block'
        } else if (currentBountyType == 2) {
          // HIDE
          document.getElementById('payoutTokenAddressInput').style.display =
            'none'
          document.getElementById('payoutVolumeInput').style.display = 'none'

          // SHOW
          document.getElementById('hasFundingGoalInput').style.display = 'block'
          document.getElementById('fundingTokenInput').style.display = 'block'
          document.getElementById('fundingGoalInput').style.display = 'block'
          document.getElementById('payoutScheduleInput').style.display = 'block'
        } else {
          // HIDE
          document.getElementById('hasFundingGoalInput').style.display = 'none'
          document.getElementById('fundingTokenInput').style.display = 'none'
          document.getElementById('fundingGoalInput').style.display = 'none'
          document.getElementById('payoutVolumeInput').style.display = 'none'

          // SHOW
          document.getElementById('payoutTokenAddressInput').style.display =
            'block'
          document.getElementById('payoutScheduleInput').style.display = 'block'
        }
      })
    }
  </script>
</html>
